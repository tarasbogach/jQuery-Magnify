(function(a){a.fn.magnify=function(){for(var b=0;b<this.length;b++){var c=a(this[b]).data("magnify");if(!c||c===null||c===""){c=new a.fn.magnify.Magnify(this[b],arguments[0],arguments[1])}else{c[arguments[0]].call(arguments[1])}}};a.fn.magnify.Magnify=function(d,b,c){c=c||{width:"200%",height:"200%"};this.element=a(d).data("magnify",this);this.options(b);this.snapshot(c);this.properties(c);this.enable()};a.fn.magnify.Magnify.prototype={whitespaceChar:" \n\r\t\f\x0b\xa0\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u200b\u2028\u2029\u3000",numberChar:"0123456789",skipEvents:0,snapshot:function(){if(arguments.length==0){return this._snapshot}else{this._snapshot=a.extend(true,{},arguments[0]);for(var b in this._snapshot){this._snapshot[b]=this.parse(this.element.css(b))}return this}},options:function(){if(arguments.length==0){return this._options}else{this._options=a.extend(true,{distance:100,distanceTo:"closest",axis:"xy",skipEvents:0,triggerEvents:false,before:null,after:null,delta:"linear"},arguments[0]);if(typeof(this._options.delta)=="string"&&this.delta[this._options.delta]){this._options.delta=this.delta[this._options.delta]}if(typeof(this._options.delta)!="function"){throw"jQuery.fn.magnify: configuration error!"}if(typeof(this._options.distanceTo)=="string"&&this.distanceTo[this._options.distanceTo]){this._options.distanceTo=this.distanceTo[this._options.distanceTo]}if(typeof(this._options.distanceTo)!="function"){throw"jQuery.fn.magnify: configuration error!"}return this}},properties:function(){if(arguments.length==0){return this._properties}else{this._properties=a.extend(true,{},arguments[0]);for(var c in this._properties){var b=this._snapshot[c][0],e=this._snapshot[c][1];if(!(this._properties[c] instanceof Array)){this._properties[c]=[this._properties[c]]}for(var d=0;d<this._properties[c].length;d++){if(typeof(this._properties[c][d])!="object"){var f=this._properties[c][d],g=(d+1)/this._properties[c].length;this._properties[c][d]={};this._properties[c][d][g]=f}for(var g in this._properties[c][d]){this._properties[c][d][g]=this.parse(this._properties[c][d][g]);if(b!="%"&&this._properties[c][d][g][0]=="%"){this._properties[c][d][g][1]=this._properties[c][d][g][1]*e/100}}}}return this}},render:function(c){if(this.skipEvents++%(this._options.skipEvents+1)!=0){return}if(this._options.triggerEvents==true){this.element.trigger("magnifybefore",{event:c})}if(typeof(this._options.before)=="function"){this._options.before.call(this.element,c)}var s=[c.pageX,c.pageY],e=[0,0],p=[this.element.outerWidth(false),this.element.outerHeight(false)];var f=this.element.get(0);do{e[0]+=f.offsetLeft;e[1]+=f.offsetTop}while(f=f.offsetParent);var b=this._options.distanceTo.call(this,s,e,p);var r=1-this._options.delta.call(this,b>this._options.distance?this._options.distance:b);for(var d in this._properties){var q=this._properties[d];var o=0,l=this._snapshot[d][1],n=this._snapshot[d][0];for(var g=0;g<q.length;g++){var j,h;for(j in q[g]){h=q[g][j][1]}if(o<=r&&r<=j){var k=(r-o)/(j-o);if(l instanceof Array){var m=[];for(var g=0;g<l.length;g++){m[g]=Math.round(l[g]+(h[g]-l[g])*k)}}else{var m=l+(h-l)*k;if(n=="px"){m=Math.round(m)}}this.element.css(d,this.make([n,m]));break}o=j;l=h}}if(typeof(this._options.after)=="function"){this._options.after.call(this.element,c)}if(this._options.triggerEvents==true){this.element.trigger("magnifyafter",{event:c})}},disable:function(){a(window).unbind("mousemove",this.render)},enable:function(){a(window).bind("mousemove",a.proxy(this.render,this))},destroy:function(){this.disable();this.element.removeData("magnify")},distanceTo:{center:function(f,c,d){var b=this._options.axis.indexOf("x")==-1?0:f[0]-(c[0]+d[0]/2);var e=this._options.axis.indexOf("y")==-1?0:f[1]-(c[1]+d[1]/2);return Math.round(Math.sqrt(Math.pow(b,2)+Math.pow(e,2)))},closest:function(l,e,k){if(this._options.axis.indexOf("x")==-1){var j=0}else{var j=0,d=l[0],c=e[0],b=c+k[0];if(d<c){j=c-d}else{if(b<d){j=d-b}}}if(this._options.axis.indexOf("y")==-1){var h=0}else{var h=0,i=l[1],g=e[1],f=g+k[1];if(i<g){h=g-i}else{if(f<i){h=i-f}}}return Math.round(Math.sqrt(Math.pow(j,2)+Math.pow(h,2)))}},delta:{linear:function(b){return b/this._options.distance},sin:function(b){return Math.sin(2*Math.PI*b/this._options.distance)},cos:function(b){return Math.cos(2*Math.PI*b/this._options.distance)}},trim:function(c){var d=0,b=c.length;while(this.whitespaceChar.indexOf(c.charAt(d))>-1&&d<b){d++}while(this.whitespaceChar.indexOf(c.charAt(b))>-1&&d<b){b--}return c.slice(d,b+1)},parse:function(f){if(typeof(f)!="string"){return[null,f]}f=this.trim(f);switch(true){case f.charAt(0)=="#":var g=parseInt(f.slice(1),16),h=[];if(f.length<=5){var c=f.length-1;for(var d=c-1;d>-1;d--){h.push((g>>(4*d)&15)|((g>>(4*d)&15)<<4))}}else{var c=(f.length-1)/2;for(var d=c-1;d>-1;d--){h.push(g>>(8*d)&255)}}if(h.length==3){var j="rgb"}else{var j="rgba";h[3]=parseFloat((h[3]/255).toPrecision(2))}return[j,h];case f.indexOf("rgb(")===0||f.indexOf("rgba(")===0:var e=f.indexOf("("),k=f.indexOf(")"),h=f.slice(e+1,k).split(","),j=h.length==3?"rgb":"rgba";for(var d=0;d<h.length;d++){h[d]=parseFloat(h[d])}return[j,h];default:var h=parseFloat(f);var b=f.length-1;while(this.numberChar.indexOf(f.charAt(b))===-1&&b>0){b--}var j=f.slice(b+1);if(j===""){j=null}return[j,h]}},make:function(b){switch(b[0]){case"rgb":case"rgba":return b[0]+"("+b[1].join(",")+")";case null:return b[1];default:return b[1]+b[0]}}}})(jQuery);